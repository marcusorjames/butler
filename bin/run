#!/bin/sh
# Docker run

PACKAGE="butler run"
SCRIPTS_DIR="$DIR/scripts"
DIR="$DIR/bin"

COMMON=$DIR/common
. $COMMON/colours.sh
. $COMMON/functions.sh

print_usage() {
  echo "Run a custom script"
  echo " "
  echo "SYNOPSIS:"
  echo " "
  echo "$PACKAGE script... [options]"
  echo ""
}

[ ! "$#" -gt 0 ] && print_usage && exit 1

site=$(basename "$CURRENT_SITE_DIR")

if ! site_dir="$(get_site_dir $site)"; then
  die_with_error "Site ${CWarn}$site${Color_Off} doesn't exist"
fi

cmd_name="$1"
site_cmd="$CURRENT_SITE_DIR/scripts/$cmd_name"
cmd="$SCRIPTS_DIR/$cmd_name"

shift

# Run script
if [ -f $site_cmd ]; then
  . $site_cmd "$@"
  exit 0
elif [ -f $cmd ]; then
  . $cmd "$@"
  exit 0
else
  echo -e "${CError}Error: $site_cmd or $cmd doesn't exists" && exit 1
fi
